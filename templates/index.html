<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Ï†úÌíà Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</title>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<style>
:root{
--bg:#f4f6fb;
--card:#ffffff;
--primary:#4f46e5;
--text:#1f2937;
--sub:#6b7280;
--border:#e5e7eb;
--shadow:0 20px 50px rgba(0,0,0,0.08);
}

[data-theme="dark"]{
--bg:#111827;
--card:#1f2937;
--text:#f9fafb;
--sub:#9ca3af;
--border:#374151;
--shadow:0 20px 50px rgba(0,0,0,0.4);
}

body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
background:var(--bg);
color:var(--text);
transition:.3s;
}

.container{
max-width:1000px;
margin:60px auto;
padding:40px;
background:var(--card);
border-radius:20px;
box-shadow:var(--shadow);
}

h1{
text-align:center;
margin-bottom:10px;
}

.sub{
text-align:center;
color:var(--sub);
margin-bottom:40px;
}

.input-wrap{
display:flex;
gap:10px;
margin-bottom:30px;
}

input{
flex:1;
padding:15px;
border-radius:12px;
border:1px solid var(--border);
font-size:16px;
}

button{
padding:15px 25px;
border:none;
border-radius:12px;
background:var(--primary);
color:white;
font-weight:600;
cursor:pointer;
}

button.secondary{
background:#6b7280;
}

.progress{
height:6px;
background:var(--border);
border-radius:3px;
overflow:hidden;
margin:20px 0;
display:none;
}

.progress-bar{
height:100%;
width:0%;
background:var(--primary);
transition:.4s;
}

.result{
margin-top:40px;
line-height:1.8;
}

.score-card{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
gap:20px;
margin:30px 0;
}

.score-box{
padding:20px;
border-radius:16px;
background:var(--bg);
text-align:center;
}

.score-box h3{
margin:0;
font-size:14px;
color:var(--sub);
}

.score-value{
font-size:28px;
font-weight:700;
margin-top:5px;
color:var(--primary);
}

.toggle{
position:absolute;
top:20px;
right:20px;
cursor:pointer;
font-size:14px;
color:var(--sub);
}
</style>
</head>
<body>

<div class="toggle" onclick="toggleTheme()">üåô Îã§ÌÅ¨Î™®Îìú</div>

<div class="container">
<h1>AI Ï†úÌíà Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</h1>
<p class="sub">Ïã§Ï†ú Î¶¨Î∑∞ Í∏∞Î∞ò Ï†ïÎ∞Ä Ï†êÏàò Î∂ÑÏÑù</p>

<div class="input-wrap">
<input id="product" placeholder="Ï†úÌíàÎ™Ö ÏûÖÎ†• (Ïòà: ÏïÑÏù¥Ìè∞ 15)">
<button onclick="analyze()">Î∂ÑÏÑù ÏãúÏûë</button>
</div>

<div class="progress">
<div class="progress-bar" id="bar"></div>
</div>

<div id="result" class="result"></div>
</div>

<script>
function toggleTheme(){
const html=document.documentElement;
html.dataset.theme=html.dataset.theme==="dark"?"light":"dark";
}

async function analyze(){
const name=document.getElementById("product").value.trim();
if(!name) return;

const result=document.getElementById("result");
const bar=document.getElementById("bar");
document.querySelector(".progress").style.display="block";
bar.style.width="5%";
result.innerHTML="";

const evtSource=new EventSource(`/analyze?product=${encodeURIComponent(name)}`);

evtSource.onmessage=function(event){
const data=JSON.parse(event.data);

if(data.p){
bar.style.width=data.p+"%";
}

if(data.answer){
renderReport(data.answer);
evtSource.close();
}
};

evtSource.onerror=function(){
evtSource.close();
result.innerHTML="<p style='color:red;'>Ïò§Î•ò Î∞úÏÉù</p>";
};
}

function renderReport(md){
const html=marked.parse(md);
document.getElementById("result").innerHTML=html;
}
</script>

</body>
</html>
