<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì œí’ˆ ë¶„ì„ê¸°/title>
    <style>
        :root { --primary: #1a73e8; --error: #d93025; --success: #188038; --bg: #f8f9fa; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); padding: 20px; color: #333; margin: 0; line-height: 1.7; }
        .container { max-width: 800px; margin: 40px auto; background: #fff; padding: 40px; border-radius: 24px; box-shadow: 0 10px 40px rgba(0,0,0,0.06); }
        
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { font-size: 26px; color: var(--primary); margin-bottom: 12px; }
        .header p { font-size: 15px; color: #666; }

        .input-group { display: flex; gap: 10px; margin-bottom: 25px; }
        input { flex: 1; padding: 16px; border: 2px solid #e0e0e0; border-radius: 14px; font-size: 16px; outline: none; transition: 0.2s; }
        input:focus { border-color: var(--primary); background: #fff; }
        button { padding: 0 30px; background: var(--primary); color: white; border: none; border-radius: 14px; font-weight: bold; cursor: pointer; font-size: 16px; }
        button:hover { background: #1557b0; }

        /* ìƒíƒœ ì•Œë¦¼ì°½ */
        .status-box { margin-bottom: 15px; min-height: 24px; display: flex; align-items: center; gap: 8px; }
        #status { font-size: 14px; font-weight: 500; }
        .loader { width: 16px; height: 16px; border: 2px solid #f3f3f3; border-top: 2px solid var(--primary); border-radius: 50%; display: none; animation: spin 1s linear infinite; }
        
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* ë¶„ì„ ê²°ê³¼ ì¶œë ¥ì°½ */
        #result { 
            background: #ffffff; border: 1px solid #eee; padding: 30px; border-radius: 20px; 
            font-size: 16px; color: #3c4043; white-space: pre-wrap; word-break: break-all;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
        }
        .data-info-tag { display: inline-block; margin-top: 15px; padding: 4px 12px; background: #e8f0fe; color: var(--primary); border-radius: 20px; font-size: 12px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>ë¦¬ë·° ìˆ˜ì§‘ë¶€í„° AI ìš”ì•½ê¹Œì§€, í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</h1>
        <p>ì›¹ ë¦¬ë·°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ íƒìƒ‰í•˜ê³  ì œí’ˆ ì¼ì¹˜ ì—¬ë¶€ë¥¼ ê²€ìˆ˜í•œ ë’¤ ë¶„ì„í•©ë‹ˆë‹¤.</p>
    </div>

    <div class="input-group">
        <input type="text" id="pName" placeholder="ì •í™•í•œ ì œí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ê°¤ëŸ­ì‹œ S24 ìš¸íŠ¸ë¼)">
        <button onclick="runAnalysis()">ë¦¬í¬íŠ¸ ìƒì„±</button>
    </div>

    <div class="status-box">
        <div id="loader" class="loader"></div>
        <div id="status"></div>
    </div>

    <div id="result">
        ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤. 
        AIê°€ ê´€ë ¨ ì—†ëŠ” ì œí’ˆ ì •ë³´ë¥¼ ê±¸ëŸ¬ë‚´ê³  ì¥ë‹¨ì ê³¼ ì ìˆ˜ë¥¼ ì •ë¦¬í•´ ë“œë¦½ë‹ˆë‹¤.
    </div>
</div>

<script>
    async function runAnalysis() {
        const pName = document.getElementById('pName').value;
        const resultDiv = document.getElementById('result');
        const statusDiv = document.getElementById('status');
        const loader = document.getElementById('loader');

        if(!pName) {
            alert("ë¶„ì„í•  ì œí’ˆëª…ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }

        // ì´ˆê¸°í™”
        loader.style.display = "block";
        statusDiv.style.color = "#1a73e8";
        statusDiv.innerText = "ğŸŒ ì›¹ì—ì„œ ë°ì´í„°ë¥¼ ê¸ì–´ì™€ ì œí’ˆ ì¼ì¹˜ ì—¬ë¶€ë¥¼ ê²€ìˆ˜ ì¤‘ì…ë‹ˆë‹¤...";
        resultDiv.innerHTML = '<p style="color:#888;">ì‹¤ì‹œê°„ ë¦¬ë·°ë¥¼ íƒìƒ‰í•˜ê³  AIê°€ í•­ëª©ë³„ë¡œ ë¶„ë¥˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”...</p>';

        const formData = new FormData();
        formData.append('user_input', pName);

        try {
            const res = await fetch('/chat', { method: 'POST', body: formData });
            const data = await res.json();
            
            loader.style.display = "none";

            if(data.answer) {
                // ì œí’ˆ ì •ë³´ë¥¼ ì°¾ì§€ ëª»í–ˆì„ ë•Œì˜ ì²˜ë¦¬
                if(data.data_info === "ê²€ì¦ëœ ë°ì´í„° ì—†ìŒ") {
                    statusDiv.style.color = "#d93025";
                    statusDiv.innerText = "âš ï¸ ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ë¥¼ ì°¾ì§€ ëª»í•¨";
                } else {
                    statusDiv.style.color = "#188038";
                    statusDiv.innerText = "âœ… " + data.data_info;
                }
                resultDiv.innerText = data.answer;
            } else {
                statusDiv.style.color = "#d93025";
                statusDiv.innerText = "âŒ ì˜¤ë¥˜ ë°œìƒ";
                resultDiv.innerText = "ì—ëŸ¬: " + (data.error || "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            }
        } catch(e) {
            loader.style.display = "none";
            statusDiv.style.color = "#d93025";
            statusDiv.innerText = "âŒ ì—°ê²° ì‹¤íŒ¨";
            resultDiv.innerText = "ì„œë²„ì™€ ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.";
        }
    }
</script>

</body>
</html>
